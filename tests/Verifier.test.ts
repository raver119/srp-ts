/**
 * jest-environment: node
 */
import {expect, describe, test} from "@jest/globals"
import {computeVerifier, params} from "../src";

describe("Verifier tests", () => {
    test("verifier A", () => {
        expect(Array.from(computeVerifier(params["2048"], "login", "password", "salt"))).toStrictEqual([11, 76, 122, 23, 21, 29, 192, 217, 105, 91, 152, 134, 220, 58, 130, 221, 23, 113, 66, 198, 194, 187, 204, 139, 7, 52, 89, 17, 195, 146, 83, 99, 224, 44, 3, 127, 208, 194, 170, 202, 78, 56, 13, 62, 91, 24, 227, 117, 134, 85, 13, 142, 192, 77, 79, 30, 148, 65, 133, 198, 142, 60, 243, 73, 4, 175, 232, 86, 196, 44, 216, 61, 19, 49, 103, 147, 200, 63, 117, 20, 11, 88, 99, 10, 163, 51, 147, 4, 222, 69, 161, 198, 60, 51, 224, 47, 102, 144, 187, 112, 23, 57, 200, 20, 234, 45, 56, 135, 240, 89, 57, 84, 85, 252, 112, 144, 40, 198, 152, 35, 111, 126, 103, 188, 28, 145, 252, 206, 5, 48, 195, 77, 32, 0, 67, 110, 131, 7, 132, 195, 2, 240, 110, 72, 25, 18, 89, 243, 219, 66, 226, 253, 22, 107, 27, 76, 36, 7, 17, 23, 193, 121, 119, 37, 219, 108, 62, 188, 79, 79, 165, 252, 210, 0, 30, 60, 84, 196, 254, 120, 51, 65, 82, 91, 207, 63, 228, 89, 180, 67, 55, 36, 10, 171, 191, 160, 225, 25, 97, 28, 128, 112, 136, 126, 128, 0, 235, 128, 157, 37, 142, 66, 75, 103, 5, 166, 31, 61, 140, 210, 52, 130, 252, 167, 246, 24, 44, 151, 137, 14, 17, 63, 119, 7, 134, 137, 132, 89, 9, 148, 234, 29, 252, 43, 233, 58, 158, 148, 245, 131, 120, 131, 229, 206, 148, 205])
    })

    test("verifier B", () => {
        expect(Array.from(computeVerifier(params["2048"], "login", "password", "соль"))).toStrictEqual([67, 27, 133, 144, 208, 105, 86, 246, 92, 1, 238, 38, 194, 58, 166, 183, 104, 148, 112, 210, 117, 108, 138, 169, 225, 172, 49, 211, 142, 54, 15, 0, 36, 1, 54, 211, 118, 177, 103, 164, 161, 39, 20, 86, 114, 220, 229, 191, 150, 126, 39, 62, 129, 84, 106, 44, 102, 248, 80, 228, 245, 19, 221, 4, 212, 100, 83, 156, 195, 22, 175, 183, 233, 168, 71, 82, 247, 216, 111, 65, 236, 98, 220, 18, 223, 125, 89, 80, 182, 232, 139, 223, 154, 205, 86, 184, 130, 168, 87, 193, 57, 222, 29, 223, 80, 228, 136, 57, 180, 98, 100, 195, 135, 189, 53, 255, 10, 173, 14, 208, 170, 43, 56, 48, 159, 19, 209, 86, 79, 61, 128, 103, 68, 35, 227, 172, 84, 180, 48, 170, 71, 152, 228, 113, 172, 41, 9, 86, 164, 73, 232, 143, 176, 99, 122, 17, 86, 99, 140, 238, 226, 17, 159, 37, 197, 156, 193, 110, 84, 136, 143, 155, 210, 97, 186, 77, 123, 103, 134, 202, 136, 113, 82, 45, 46, 151, 15, 206, 155, 106, 94, 46, 105, 150, 204, 86, 106, 49, 248, 139, 35, 49, 66, 102, 71, 21, 60, 247, 115, 165, 56, 6, 141, 26, 197, 174, 85, 49, 169, 239, 176, 166, 27, 246, 66, 105, 158, 160, 178, 6, 231, 94, 193, 25, 250, 187, 216, 64, 191, 110, 23, 26, 15, 153, 15, 104, 194, 174, 148, 70, 252, 245, 43, 214, 209, 126])
    })
})